/*! For license information please see 22.23c73d03.chunk.js.LICENSE.txt */
(this["webpackJsonpstreamlit-browser"]=this["webpackJsonpstreamlit-browser"]||[]).push([[22],{3447:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(9),a=function(){function e(t,n,i,a){Object(r.a)(this,e),this.name=void 0,this.size=void 0,this.status=void 0,this.id=void 0,this.name=t,this.size=n,this.id=i,this.status=a}return Object(i.a)(e,[{key:"setStatus",value:function(t){return new e(this.name,this.size,this.id,t)}}]),e}()},5743:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ee}));var r,i=n(16),a=n(6),o=n(9),s=n(7),c=n(8),l=n(91),d=n(216),u=n.n(d),f=n(39),p=n.n(f),h=n(0),g=n.n(h),m=n(21),b=n(75),j=n(74),S=n(148),v=n(146),w=n(212),x=n(22),F=n(3447),O=n(363),I=n(10),C=n(13),y=n.n(C),R=n(32);!function(e){e.XSMALL="xsmall",e.SMALL="small",e.MEDIUM="medium",e.LARGE="large"}(r||(r={}));var E=y()("div",{target:"ejtjsn20"})((function(e){e.theme,e.width;return{position:"relative",width:"100%",objectFit:"contain"}}),""),M=y()("div",{target:"ejtjsn21"})((function(e){var t=e.theme,n=e.width;return{backgroundColor:t.colors.secondaryBg,borderRadius:"".concat(t.radii.md," ").concat(t.radii.md," 0 0"),width:n,height:9*n/16,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}),""),P=y()("p",{target:"ejtjsn22"})((function(e){return{marginTop:e.theme.spacing.sm,textAlign:"center"}}),""),T=y()("img",{target:"ejtjsn23"})((function(e){var t=e.theme,n=e.opacity;return{borderRadius:"".concat(t.radii.md," ").concat(t.radii.md," 0 0"),objectFit:"contain",opacity:n}}),""),U=y()("a",{target:"ejtjsn24"})((function(e){return{color:e.theme.colors.primary,display:"block",textDecoration:"none"}}),""),k=y()("span",{target:"ejtjsn25"})((function(e){e.theme;return{display:"flex",alignItems:"center"}}),""),L=y()("div",{target:"ejtjsn26"})((function(e){var t=e.theme;return{position:"absolute",top:t.spacing.lg,right:t.spacing.lg,zIndex:1,color:t.colors.fadedText40,mixBlendMode:"difference",opacity:.6}}),""),D=(y()("div",{target:"ejtjsn27"})((function(e){e.theme;return{display:"flex"}}),""),y()("div",{target:"ejtjsn28"})((function(e){e.theme;return{height:"fit-content",width:"100%",position:"absolute",bottom:0}}),"")),N=y()("button",{target:"ejtjsn29"})((function(e){var t=e.theme;return Object(I.a)({position:"relative",display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:t.colors.lightenedBg05,border:"1px solid ".concat(t.colors.fadedText10),borderRadius:"0 0 ".concat(t.radii.md," ").concat(t.radii.md),"&:hover":{borderColor:t.colors.primary,color:t.colors.primary},"&:active":{color:t.colors.white,borderColor:t.colors.primary,backgroundColor:t.colors.primary},"&:focus:not(:active)":{borderColor:t.colors.primary,color:t.colors.primary},"&:disabled, &:disabled:hover, &:disabled:active":{color:t.colors.fadedText40},fontWeight:t.fontWeights.normal,padding:"".concat(t.spacing.xs," ").concat(t.spacing.md),margin:0,lineHeight:t.lineHeights.base,color:"inherit",width:"100%",userSelect:"none","&:focus":{boxShadow:"0 0 0 0.2rem ".concat(Object(R.transparentize)(t.colors.primary,.5)),outline:"none"}},function(e,t){switch(e){case r.XSMALL:return{padding:"".concat(t.spacing.twoXS," ").concat(t.spacing.sm),fontSize:t.fontSizes.sm};case r.SMALL:return{padding:"".concat(t.spacing.twoXS," ").concat(t.spacing.md)};case r.LARGE:return{padding:"".concat(t.spacing.md," ").concat(t.spacing.md)};default:return{padding:"".concat(t.spacing.xs," ").concat(t.spacing.md)}}}(r.MEDIUM,t))}),""),z=n(5);var _,G=function(e){var t=e.disabled,n=e.onClick,r=e.children,i=e.progress;return Object(z.jsxs)(N,{disabled:t||!1,onClick:n||function(){},progress:i||null,children:[r,i&&Object(z.jsx)(D,{children:Object(z.jsx)(O.b,{value:i,size:O.a.EXTRASMALL,overrides:{Bar:{style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}},BarProgress:{style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}},BarContainer:{style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}}}})})]})},V=n(4354),A=n(28),W=n(282);!function(e){e.USER="user",e.ENVIRONMENT="environment"}(_||(_={}));var X,B=function(e){var t=e.switchFacingMode;return Object(z.jsx)(L,{children:Object(z.jsx)(j.d,{content:"Switch camera",placement:j.b.TOP_RIGHT,children:Object(z.jsx)(A.d,{kind:A.b.MINIMAL,onClick:t,children:Object(z.jsx)(b.a,{content:V.SwitchCamera,size:"twoXL",color:W.a.white})})})})},H=n(20),J=n(37),q=n(5672),Q=n(5675),K=n.n(Q),Y=n(50);!function(e){e.PENDING="pending",e.SUCCESS="success",e.ERROR="error"}(X||(X={}));var Z=function(e){var t=e.width;return Object(z.jsxs)(M,{width:t,children:[Object(z.jsx)(b.a,{size:"threeXL",color:W.a.gray60,content:l.Video}),Object(z.jsxs)(P,{children:["This app would like to use your camera.",Object(z.jsx)(U,{href:Y.b,rel:"noopener noreferrer",target:"_blank",children:"Learn how to allow access."})]})]})},$=function(e){var t=e.handleCapture,n=e.width,r=e.disabled,i=e.clearPhotoInProgress,a=e.setClearPhotoInProgress,o=e.facingMode,s=e.setFacingMode,c=Object(h.useState)(X.PENDING),l=Object(H.a)(c,2),d=l[0],u=l[1],f=Object(h.useRef)(null);var p=Object(J.useTheme)();return Object(z.jsxs)(E,{width:n,children:[d===X.SUCCESS||r||i?q.isMobile&&Object(z.jsx)(B,{switchFacingMode:s}):Object(z.jsx)(Z,{width:n}),Object(z.jsx)(M,{hidden:d!==X.SUCCESS&&!r&&!i,width:n,children:!r&&Object(z.jsx)(K.a,{audio:!1,ref:f,screenshotFormat:"image/jpeg",screenshotQuality:1,width:n,height:9*n/16,style:{borderRadius:"".concat(p.radii.md," ").concat(p.radii.md," 0 0")},onUserMediaError:function(){u(X.ERROR)},onUserMedia:function(){u(X.SUCCESS),a(!1)},videoConstraints:{width:{ideal:n},facingMode:o}})}),Object(z.jsx)(G,{onClick:function(){if(null!==f.current){var e=f.current.getScreenshot();t(e)}},disabled:d!==X.SUCCESS||r||i,children:"Take Photo"})]})};var ee=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).localFileIdCounter=1,r.RESTORED_FROM_WIDGET_STRING="RESTORED_FROM_WIDGET",r.formClearHelper=new w.b,r.getProgress=function(){if(r.state.files.length>0&&"uploading"===r.state.files[r.state.files.length-1].status.type)return r.state.files[r.state.files.length-1].status.progress},r.setClearPhotoInProgress=function(e){r.setState({clearPhotoInProgress:e})},r.setFacingMode=function(){r.setState((function(e){return{facingMode:e.facingMode===_.USER?_.ENVIRONMENT:_.USER}}))},r.handleCapture=function(e){if(null===e)return Promise.resolve();r.setState({imgSrc:e,shutter:!0,minShutterEffectPassed:!1});var t,n;return(t=e,n="camera-input-".concat((new Date).toISOString().replace(/:/g,"_"),".jpg"),fetch(t).then((function(e){return e.arrayBuffer()})).then((function(e){return new File([e],n,{type:"image/jpeg"})}))).then((function(e){return r.uploadFile(e)})).then((function(){return e=150,new Promise((function(t){return setTimeout(t,e)}));var e})).then((function(){r.setState({imgSrc:e,shutter:r.state.shutter,minShutterEffectPassed:!0})})).catch((function(e){Object(x.b)(e)}))},r.removeCapture=function(){0!==r.state.files.length&&(r.state.files.forEach((function(e){return r.deleteFile(e.id)})),r.setState({imgSrc:null,clearPhotoInProgress:!0}))},r.componentDidUpdate=function(e){var t=r.props,n=t.element,i=t.widgetMgr;if(e.disabled!==r.props.disabled&&r.props.disabled)return r.reset(),void i.setFileUploaderStateValue(n,new m.h,{fromUi:!1});if("ready"===r.status){var a=r.createWidgetValue();if(void 0!==a){var o=i.getFileUploaderStateValue(n);p.a.isEqual(a,o)||i.setFileUploaderStateValue(n,a,{fromUi:!0})}}},r.onFormCleared=function(){r.setState({files:[]},(function(){var e=r.createWidgetValue();null!=e&&(r.setState({imgSrc:null}),r.props.widgetMgr.setFileUploaderStateValue(r.props.element,e,{fromUi:!0}))}))},r.render=function(){var e=r.props,t=e.element,n=e.widgetMgr,i=e.disabled,a=e.width;return r.formClearHelper.manageFormClearListener(n,t.formId,r.onFormCleared),Object(z.jsxs)(E,{width:a,className:"row-widget","data-testid":"stCameraInput",children:[Object(z.jsx)(v.d,{label:t.label,disabled:i,children:t.help&&Object(z.jsx)(v.b,{children:Object(z.jsx)(S.a,{content:t.help,placement:j.b.TOP_RIGHT})})}),r.state.imgSrc?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(M,{width:a,children:r.state.imgSrc!==r.RESTORED_FROM_WIDGET_STRING&&Object(z.jsx)(T,{src:r.state.imgSrc,alt:"Snapshot",opacity:r.state.shutter||!r.state.minShutterEffectPassed?"50%":"100%",width:a,height:9*a/16})}),Object(z.jsx)(G,{onClick:r.removeCapture,progress:r.getProgress(),disabled:!!r.getProgress()||i,children:r.getProgress()?"Uploading...":Object(z.jsxs)(k,{children:[Object(z.jsx)(b.a,{content:l.X,margin:"0 xs 0 0",size:"sm"})," Clear photo"]})})]}):Object(z.jsx)($,{handleCapture:r.handleCapture,width:a,disabled:i,clearPhotoInProgress:r.state.clearPhotoInProgress,setClearPhotoInProgress:r.setClearPhotoInProgress,facingMode:r.state.facingMode,setFacingMode:r.setFacingMode})]})},r.deleteFile=function(e){var t=r.getFile(e);null!=t&&("uploading"===t.status.type&&t.status.cancelToken.cancel(),r.removeFile(e))},r.addFile=function(e){r.setState((function(t){return{files:[].concat(Object(i.a)(t.files),[e])}}))},r.removeFile=function(e){r.setState((function(t){return{files:t.files.filter((function(t){return t.id!==e}))}}))},r.getFile=function(e){return r.state.files.find((function(t){return t.id===e}))},r.updateFile=function(e,t){r.setState((function(n){return{files:n.files.map((function(n){return n.id===e?t:n}))}}))},r.onUploadComplete=function(e,t){r.setState((function(e){return{newestServerFileId:Math.max(e.newestServerFileId,t),shutter:!1}}));var n=r.getFile(e);null!=n&&"uploading"===n.status.type&&r.updateFile(n.id,n.setStatus({type:"uploaded",serverFileId:t}))},r.onUploadProgress=function(e,t){var n=r.getFile(t);if(null!=n&&"uploading"===n.status.type){var i=Math.round(100*e.loaded/e.total);n.status.progress!==i&&r.updateFile(t,n.setStatus({type:"uploading",cancelToken:n.status.cancelToken,progress:i}))}},r.reset=function(){r.setState({files:[],imgSrc:null})},r.uploadFile=function(e){var t=u.a.CancelToken.source(),n=new F.a(e.name,e.size,r.nextLocalFileId(),{type:"uploading",cancelToken:t,progress:1});r.addFile(n),r.props.uploadClient.uploadFile(r.props.element,e,(function(e){return r.onUploadProgress(e,n.id)}),t.token).then((function(e){return r.onUploadComplete(n.id,e)})).catch((function(e){u.a.isCancel(e)||r.updateFile(n.id,n.setStatus({type:"error",errorMessage:e?e.toString():"Unknown error"}))}))},r.state=r.initialValue,r}return Object(o.a)(n,[{key:"initialValue",get:function(){var e=this,t={files:[],newestServerFileId:0,imgSrc:null,shutter:!1,minShutterEffectPassed:!0,clearPhotoInProgress:!1,facingMode:_.USER},n=this.props,r=n.widgetMgr,i=n.element,a=r.getFileUploaderStateValue(i);if(null==a)return t;var o=a.maxFileId,s=a.uploadedFileInfo;return null==o||0===o||null==s?t:{files:s.map((function(t){var n=t.name,r=t.size,i=t.id;return new F.a(n,r,e.nextLocalFileId(),{type:"uploaded",serverFileId:i})})),newestServerFileId:Number(o),imgSrc:0===s.length?"":this.RESTORED_FROM_WIDGET_STRING,shutter:!1,minShutterEffectPassed:!1,clearPhotoInProgress:!1,facingMode:_.USER}}},{key:"componentWillUnmount",value:function(){this.formClearHelper.disconnect()}},{key:"status",get:function(){return this.state.files.some((function(e){return"uploading"===e.status.type}))?"updating":"ready"}},{key:"createWidgetValue",value:function(){if(0!==this.state.newestServerFileId){var e=this.state.files.filter((function(e){return"uploaded"===e.status.type})).map((function(e){var t=e.name,n=e.size,r=e.status;return new m.t({id:r.serverFileId,name:t,size:n})}));return new m.h({maxFileId:this.state.newestServerFileId,uploadedFileInfo:e})}}},{key:"nextLocalFileId",value:function(){return this.localFileIdCounter++}}]),n}(g.a.PureComponent)}}]);